---
title: "Stock enhancement undermines community stability"
output:
  word_document:
    reference_docx: word_format.docx
csl: pnas.csl
knit: (function(inputFile, encoding) {
        rmarkdown::render(inputFile, encoding = encoding, output_dir = "document_output")
      })
bibliography: reference.bib
---

```{r setup, include=FALSE}

# setup
knitr::opts_chunk$set(echo = TRUE)
pacman::p_load(tidyverse)
op <- function(x, d = 2) sprintf(paste0("%1.", d, "f"), x) 

# theory
load(here::here("result/result_ricker.RData"))

n_sim <- sim_result %>% 
  mutate(n_sim = n_warmup + n_burnin + n_timestep) %>% 
  pull(n_sim) %>% 
  unique()

param_set <- sim_result %>% 
  distinct(n_species,
           k,
           r_type,
           r1,
           r_min,
           r_max,
           sd_env,
           phi,
           int_type,
           alpha,
           model,
           seed)

# empirical data

source(here::here("code/data_fmt_fishdata.R"))

filename <- list.files(path = here::here("result"), full.names = T) %>% 
  as_tibble() %>% 
  filter(str_detect(string = .$value, pattern = "reg")) %>% 
  filter(!str_detect(string = .$value, pattern = "reg_rich")) %>% 
  pull()

df_beta <- lapply(filename, function(x) {
  read_csv(here::here(x)) %>% 
    filter(parameter == "b[2]")
})
names(df_beta) <- str_extract(filename, "all|masu|other")  

```

**Authors:** Akira Terui^1,\*^, Hirokazu Urabe^2^, Masayuki Senzaki^3^, Bungo Nishizawa^4^

\*Corresponding author: hanabi0111\@gmail.com

**Affiliations:** ^1^ Department of Biology, University of North Carolina at Greensboro, Greensboro, NC 27412, USA ^2^ Department of Ecology, Evolution and Behavior, University of Minnesota, St. Paul, MN 55108, USA ^3^ National Institute for Environmental Studies, Tsukuba, Ibaraki 305-8506, Japan ^4^ Shiraume Gakuen College, Kodaira, Tokyo 187-8570, Japan

# Maintext

Anthropogenic influences have caused global biodiversity crisis, such that human interventions are critical to the sustainable management of natural resources [@cardinaleBiodiversityLossIts2012]. Captive breeding is a common practice to conserve or enhance wild populations of diverse plant and animal taxa [@snyderLimitationsCaptiveBreeding1996]. Although there is growing recognition that stock enhancement with captive-bred organisms entails ecological risks (e.g., the accumulation of deleterious alleles) [@arakiGeneticEffectsCaptive2007a; @krkosekDecliningWildSalmon2007], this method is still pervasive in conservation [@snyderLimitationsCaptiveBreeding1996; @griffithsCaptiveBreedingReintroduction2008; @haagNorthAmericanFreshwater2012] and fisheries [@kitadaEconomicEcologicalGenetic2018; @arakiHatcheryStockingHelp2010]. In fisheries for example, billions of hatchery-reared individuals are released annually across the globe [@kitadaEconomicEcologicalGenetic2018]. The widespread use of captive breeding is perhaps because of the "myth" that numerical benefits of released individuals may exceed the associated risks.

Current debates, however, overlook the fact that we have rarely assessed the community-wide impact of stock enhancement. Species are all embedded in the complex web of interacting organisms, and stable coexistence of competing species through density-dependent feedback underpins emergent stability of ecological communities [@tilmanEcologicalConsequencesChanges1999a; @carrollNicheFitnessDifferences2011a; @loreauDoesFunctionalRedundancy2004]. Stock enhancement may disrupt the sensitive balance of species interactions because it introduces unnaturally high numbers of individuals into the wild [@weberInteractionsHatcheryWild2003; @careyNativeInvadersChallenges2012]. Hence, this form of species management may have significant consequences for community dynamics in the long term. Evidence for this hypothesis is lacking, however.

Here, we use a simple theory to show that stock enhancement undermines long-term community stability, which we define here as the relative size of fluctuations in total community density over time [@tilmanEcologicalConsequencesChanges1999a]. Our theory illuminates that stock enhancement interferes with the internal regulation process of self-sustainable communities, compromising the stabilizing mechanism emerging from species niche differences. The present study further demonstrates the relevance of this general theory to natural systems by showing its congruence with Japanese stream fish communities, where \>10 million hatchery masu salmon (*Oncorhynchus masou masou*) are released annually for fisheries, recreation, and conservation purposes [@kitadaLessonsJapanMarine2020]. Our findings paint a bleak picture for stock enhancement, reinforcing the recurrent calls for alternative management strategies.

## Theoretical predictions

We employed a multispecies Ricker model [@fowlerSpeciesDynamicsAlter2012] to simulate community dynamics with selective stock enhancement of a constituent species (species 1). Specifically, population density of species $i$ at time $t+1$, $N_{i,t+1}$, is modeled as:

$$
N_{i,t+1} = (N_{i,t}+\phi_i R_t)~exp[r_i(1-\frac{N_{i,t}+\alpha_{i1} R_t + \sum_{j=1}^S \alpha_{ij}N_{j,t}}{K_i})]~exp(\epsilon_{i,t})
$$

where $r_i$ is the intrinsic growth rate (drawn from a uniform distribution as $r_i \sim Unif(0,2)$ except $r_1$), $\alpha_{ij}$ the competition coefficient of species $j$ on species $i$ [drawn from an exponential distribution as $\alpha_{ij,i \ne j} \sim Exp(1/\bar{\alpha})$; intraspecific competition $\alpha_{ii}=1$], $K_i$ the carrying capacity, $R_t$ the number of released individuals for the enhancement of species 1, and $\epsilon_{i,t}$ the species responses to stochastic environmental fluctuations that follow an normal distribution with a mean of zero and a standard deviation of $\sigma_{\epsilon}$. The parameter $\phi_i$ controls the relative fitness of captive-bred individuals as follows:

$$
\phi_i = \left\{
\begin{array}{}
f_R & (i = 1)\\
0 & (i \ne 1)
\end{array}
\right.
$$

$f_R~(\ge 0)$ is the density-independent survival of captive-bred individuals relative to wild individuals. Therefore, the model accounts for fitness difference of captive-bred individuals due to genetic effects and/or plasticity [@weberInteractionsHatcheryWild2003; @snyderLimitationsCaptiveBreeding1996; @arakiHatcheryStockingHelp2010] when considering the reproductive contribution of released individuals to the next generation of the enhanced species. Without loss of generality, we assumed constant $K_i$ ($K_i = K$) and $R_t$ ($R_t = R$) across species and time, respectively.

In our simulation, we considered `r nrow(param_set)` simulation scenarios with different values of the following ecological parameters: intrinsic growth of the enhanced species ($r_1=$ `r unique(sim_result$r1)`), average strength of interspecific competition ($\bar{\alpha}=$ `r unique(sim_result$alpha)`), carrying capacity ($K=$ `r unique(sim_result$k)`), relative fitness of captive-bred individuals ($f_R=$ `r unique(sim_result$phi)`), and degree of environmental stochasticity ($\sigma_{\epsilon}=$ `r unique(sim_result$sd_env)`). We chose these parameters because our sensitivity analysis revealed that these parameters were influential in altering the relationship between community dynamics and stock enhancement (**Supporting Information**). Under each scenario with a unique parameter combination, we ran `r n_sim` time steps of `r max(sim_result$n_rep)` independent communities (i.e., simulation replicates) with varying numbers of released individuals $R$ ($0-500$). The last `r unique(sim_result$n_timestep)` time steps were used to obtain the following summary statistics of total community density $\sum_i^SN_i$: the coefficient of variation (CV), the number of species persist (defined as $N_i > 0.01$ at $t=1600$), the temporal mean, and the temporal SD. In addition, temporal means and SDs were calculated for the enhanced ($N_1$) and unenhanced species ($\sum_{i,i \ne 1}^S N_i$) separately to infer mechanisms that underlie the community-level response.

When carrying capacity is small ($K=100$), our model predicted a destabilizing effect of selective stock enhancement on ecological communities as illustrated by increased CV with increasing numbers of released individuals $R$ (**Figure 1A**). This pattern stemmed mainly from the reduced mean of total community density, and both enhanced and unenhanced species groups were responsible (**Figure 1A**). For enhanced species, released individuals induced overcompensation, in which the negative effect of reduced per-capita reproduction due to competition exceeds the numerical benefit of released individuals. Therefore, the enhanced species reached the lower long-term average of population density with higher numbers of released individuals, confirming previous theoretical predictions [@satakeStockingCaptivebredFish2012]. Meanwhile, interspecific competition caused the reduced mean density of unenhanced species and led to decreased numbers of persisting species at high levels of stock enhancement (**Figure 1A**). Combined, the long-term average of the total community density decreased more sharply than individual species groups with stock enhancement (**Figure 1A**). The SDs showed a similar trend, but the relationship was flatter at the community level (**Figure 1A**). Since a CV is a ratio of an SD to a mean, the steeper relationship of the mean community density resulted in the increased CV. These patterns were qualitatively similar across most ecological scenarios even when interspecific competition is very weak (**Figure S1-6**).

The destabilizing effect emerges because stock enhancement undermines the balance of species interactions that underpins community stability. Ecological theory suggests that stable coexistence of competing species requires a niche difference that is large enough to overcome the relative difference in intrinsic competitive ability [@carrollNicheFitnessDifferences2011a]. Under this condition, competing species can grow from small populations because numerically dominant species undergoes stronger intraspecific competition [@carrollNicheFitnessDifferences2011a]. Such stable coexistence increases the likelihood of stabilizing temporal dynamics of species rich communities [@tilmanEcologicalConsequencesChanges1999a] because it gives rise to "overyielding" [@loreauDoesFunctionalRedundancy2004; @carrollNicheFitnessDifferences2011a], that is, total community density of a multi-species community exceeds what would be expected in a single species community ($\sum_i^S N_i > K$). However, stock enhancement is externally controlled and the number of release is not subject to density-dependent regulation. Therefore, excessive individuals supplemented through stock enhancement impose additional intra- and interspecific competition that interferes with the ecological process producing overyielding.

The only scenario where stock enhancement had little influence on community dynamics was when carrying capacity was sufficiently large ($K=500$; **Figures S7-S12**). In particular, stock enhancement increased the average density of the enhanced species with low population growth rate ($r_1=0.5$; **Figures S7 and S8**). This result may explain why some of the best evidence for successful stock enhancement comes from endangered species that typically suffer from increased mortality [@johnsonGeneticRestorationFlorida2010; @oppelPopulationReinforcementDemographic2021]. More importantly, the contrasting community response at different levels of carrying capacity provides deeper insights into ecosystem management. One of the core motivations for stock enhancement is to mitigate or reverse declining trends of biodiversity due to human impacts, such as habitat loss and fragmentation [@chaseEcosystemDecayExacerbates2020]. However, our results suggest that stock enhancement will not bring desired ecological outcomes in degraded habitats because human influences compromised environmental capacity.

## Empirical evidence

To demonstrate the relevance of our general theory to natural systems, we assessed the potential impacts of selective stock enhancement of masu salmon *Oncorhynchus masou masou* (**Figure 1E**) on the long-term stability of stream fish communities. Masu salmon is one of the most valuable freshwater resources in Hokkaido Island, Japan, and extensive hatchery programs have been implemented [@kitadaLessonsJapanMarine2020]. In protected watersheds where any forms of exploitation are prohibited (including recreational angling) (**Figure 1C and 1D**), long-term monitoring has been conducted over the past two decades along with official records of stock enhancement [@teruiMetapopulationStabilityBranching2018]. Therefore, the study system sets the stage for a "natural experiment" to test our theoretical predictions. In this study, we used the long-term data (1999-2019) of stream fish communities at `r n_distinct(df_fish$site_id)` sites within `r n_distinct(df_fish$river)` protected watersheds (see Methods for selection criterion). Using hierarchical Bayesian models, we quantified the effect of stock enhancement on community dynamics while accounting for potential confounding effects of climates and local abiotic factors.

As our theory predicts, stream fish communities showed greater temporal fluctuations (higher CV) in watersheds with greater numbers of fish released (**Figure 1B**). The positive relationship between the CV and the number of fish released was strongly supported by the statistical model (**Figure 2**), in which the probability of the regression coefficient being positive was `r op(df_beta$all$prob_positive[df_beta$all$response == "cv"])` (**Table S7**). This pattern was associated with the reduced long-term average of total community density, and both enhanced (masu salmon) and unenhanced fish groups contributed to this trend (**Tables S7-S9** and **Figure 1B and 2**). In the meantime, the SDs had vague relationships with stock enhancement, and neither positive or negative relationship was supported by statistical analysis (**Figure 1B and 2**). At the population level, similar responses to stock enhancement have been reported in other fish and aquatic invertebrates [@arakiHatcheryStockingHelp2010]. Our analysis builds upon these findings by illustrating the community-level response to stock enhancement in nature.

In our theory, the observed pattern emerges when negative density dependence operates in the recipient community, and previous observations confirm this assumption. Masu salmon typically spend one year in freshwater before migrating to the ocean, and a wealth of evidence suggests that released masu salmon compete with wild masu salmon [@sahashiEvaluationContributionHatchery2015a] and other stream fishes [@hasegawaEffectsHatcheryChum2014; @hasegawaWildMasuSalmon2018]. Hatchery-reared salmons are larger and more aggressive than wild individuals, further increasing the likelihood of intense intra- and interspecific competition in the wild [@hasegawaWildMasuSalmon2018; @weberInteractionsHatcheryWild2003]. Importantly, the number of fish released is controlled by socioeconomic factors (e.g., budget allocation). As such, released fish are "excessive" given the density-dependent regulation of recipient communities and may cause resource competition that would otherwise not exist.

Reduced fitness of captive-bred individuals may also play a role in producing the observed community response. As with other salmonid species, ocean-migrating adults of captive-bred masu salmon show lower return rates to the spawning river. It has also been shown that hatchery-reared salmons are more susceptible to predation than wild salmons [@weberInteractionsHatcheryWild2003]. The fitness disadvantage of captive-bred fish may add to negative density dependence to reduce the long-term average of community density, undermining community stability in the long term.

Like any non-experimental studies, we cannot exclude the possibility that our results were driven by spurious correlations. However, in the protected watersheds, any exploitation of aquatic species and alteration of in-stream habitats (e.g., construction of river-crossing structure) are strictly regulated; therefore, it is difficult to envision that unmeasured human influences played a major role in the observed relationships. Further, we have statistically controlled natural variation in environmental factors, including climatic and land use variables (see **Methods** and **Tables S7-S9**). This unique study setup may have helped uncover the close agreement between theory and empirical patterns.

## Implications

The past few decades have witnessed substantial efforts to unveil ecological consequences of captive breeding, and there is a general agreement that the distinctive features of captive-bred individuals bring fitness disadvantages in the wild [@arakiHatcheryStockingHelp2010; @snyderLimitationsCaptiveBreeding1996]. As such, numerous studies suggested that stock enhancement with captive breeding must be carefully employed given the potential negative impacts on wild populations [@christieGeneticAdaptationCaptivity2012; @arakiGeneticEffectsCaptive2007a]. Despite the significant attention to the fate of captive-bred individuals, current schemes rarely consider the self-regulation process of biodiversity. The results of this study suggest that the ignorance of this critical process may erode the long-term persistence of the recipient community. While our empirical example is limited to stream fish communities, the consistent emergence of destabilizing effect across simulated ecological scenarios implies that this ecological phenomenon is pervasive across terrestrial and aquatic taxa.

We should prioritize the preservation and restoration efforts of natural habitats with a broader scope of biodiversity conservation. Such efforts are particularly important in the Anthropocene because the undesired influence of stock enhancement may be exacerbated in degraded habitats. Protected areas and environmental restoration are promising tools to conserve biodiversity, and the smart spatial design is key to achieve successful conservation [@koningNetworkGrassrootsReserves2020; @akasakaSmartProtectedArea2017]. For example, coordinated placement of conservation sites considering spatial biodiversity patterns is of critical importance in improving the ecological outcomes [@akasakaSmartProtectedArea2017; @teruiEmergentDualScaling2021; @koningNetworkGrassrootsReserves2020; @stollSmallImpoverishedRegional2013]. Socioeconomic factors such as governance may also play a central role in enforcing environmental legislation, potentially determining the effectiveness of conservation investment [@amanoSuccessfulConservationGlobal2018]. These considerable potentials indicate that we have viable management options for the sustainable future of natural resources before blindly accepting stock enhancement. Without a comprehensive framework that appreciates the ecological integrity of natural communities, stock enhancement will never be effective but impairs biodiversity.

# Methods

## Theory

We employed a multispecies Ricker model. In the basic formula without stock enhancement, population density of species $i$ at time $t+1$, $N_{i,t+1}$, is modeled as:

$$
\begin{aligned}N_{i,t+1} = N_{i,t}~exp[r_i(1-\frac{N_{i,t} + \sum_{j=1}^S \alpha_{ij}N_{j,t}}{K_i})]exp(\epsilon_{i,t}) &\text{(1)}
\end{aligned}
$$

where $r_i$ is the intrinsic growth rate, $\alpha_{ij}$ the competition coefficient between species $i$ and $j$, $K_i$ the carrying capacity, and $\epsilon_{i,t}$ the species responses to stochastic environmental fluctuations that obey an normal distribution $Normal(0, \sigma_{\epsilon}^2)$. We modified this formula to include the effects of stock enhancement on reproduction and competition as follows:

$$
\begin{aligned}
N_{i,t+1} = [N_{i,t}+\phi_i R_t]exp[r_i \{1-\frac{N_{i,t}+\alpha_{i1} (N_1 + R_t) + \sum_{j=2}^S \alpha_{ij}N_{j,t}}{K_i}\}]exp(\epsilon_{i,t}) &\text{(2)}
\end{aligned}
$$

$R_t$ is the number of released individuals, and the parameter $\phi_i$ controls the relative fitness of captive-bred individuals:

$$
\begin{aligned}
\phi_i = \left\{
\begin{array}{}
f_R & (i = 1)\\
0 & (i \ne 1)
\end{array}
\right.
&\text{(3)}
\end{aligned}
$$

$f_R~(\ge 0)$ is the density-independent survival of captive-bred individuals relative to wild individuals. The equation (2) can be reorganized to:

$$
\begin{aligned}
N_{i,t+1} = [N_{i,t}+\phi_i R_t]exp[r_i(1-\frac{N_{i,t}+\alpha_{i1}R_t + \sum_{j=1}^S \alpha_{ij}N_{j,t}}{K_i})]exp(\epsilon_{i,t}) &\text{(4)}
\end{aligned}
$$

In this model, the intrinsic growth rates for unenhanced species $r_{i,i \ne 1}$ and interspecific competition $\alpha_{ij}$ are random draws from a uniform ($r_{i,i \ne 1} \sim Unif(0,r_{max})$) and an exponential distribution ($\alpha_{ij} \sim Exp(1/\bar{\alpha})$), respectively. We assumed constant values of intraspecific competition ($\alpha_{ii}=1$), carrying capacity $(K_i = K)$ and the number of release $(R_t=R)$.

Prior to the main simulation analysis, we performed an extensive sensitivity analysis to identify parameters that strongly influence the relationship between community dynamics and stock enhancement. We identified five influential parameters, of which multiple values were considered in the main simulation as follows: carrying capacity ($K=$ `r unique(param_set$k)`), intrinsic growth of enhanced species ($r_1 =$ `r unique(param_set$r1)`), degree of environmental stochasticity ($\sigma_{\epsilon}=$ `r unique(param_set$sd_env)`), relative fitness of captive-bred individuals ($f_R=$ `r unique(param_set$phi)`), and average strength of interspecific competition ($\bar{\alpha}=$ `r unique(param_set$alpha)`). We fixed values of the following parameters: the number of species ($S=$ `r unique(param_set$n_species)`) and the maximum intrinsic growth rate of unenhanced species ($r_{max}=$ `r unique(param_set$r_max)`). This simulation setup resulted in `r nrow(param_set)` sets of parameter combinations that cover a range of ecological scenarios.

Under each parameter combination, we ran `r n_sim` time steps of `r max(sim_result$n_rep)` independent communities (i.e., simulation replicates). The number of released individuals $R$ was drawn randomly from a uniform distribution for each simulation replicate as $R \sim Unif(0,500)$. We initialized the community with populations of each species drawn from a poisson distribution with a mean of five. We repeated the seeding procedure every 10 time steps over the first `r unique(sim_result$n_warmup)` time steps to allow species to establish populations and reach an equilibrium without stock enhancement (initialization period). After the initialization period, we released $R$ individuals of the enhanced species every time step over the next `r unique(sim_result$n_burnin)` time steps to reach a new equilibrium with selective stock enhancement (burn-in period). After the burn-in period, we continued the simulation run with stock enhancement and saved the last `r unique(sim_result$n_timestep)` time steps to obtain the coefficient of variation, temporal mean, and SD of whole community density ($\sum_i^SN_j$). Temporal means and SDs were also calculated for the enhanced species ($N_1$) and unenhanced species ($\sum_{i,i \ne 1}^S N_i$) separately. We summarized values of simulation parameters in **Table S1**.

## Empirical analysis

### Data

**Time-series data.** We assembled time-series data of fish abundance across `r n_distinct(d0$site_id)` sites within `r n_distinct(d0$river)` protected watersheds of Hokkaido Island, Japan. At these sites, the long-term monitoring program began in 1971 but effective sampling methods (a combination of electrofishing and cast net sampling) were implemented in 1999. Most data were collected in summer to fall with irregular sampling intervals (0 to 3 year intervals for most cases). We confined our analysis to the sites that meets the following selection criteria: (1) the observation span (from the first to the last year of observation) exceeds 10 years, (2) the number of observation years exceeds five years, and (3) masu salmon are observed at least twice during the observation period. As a result, we used time-series data of fish abundance at `r n_distinct(df_fish$site_id)` sites within `r n_distinct(df_fish$river)` during a period of 1999-2019.

**Fish stocking.** At the protected watersheds, stocking of masu salmon began in 1950s. A mixture of captive-bred and wild-born individuals were released in spring (fry [age 0+] and smolt [age 1+] stages) and fall (juvenile stage [age 0+]). For each watershed, we examined historical records and assembled annual data of stock enhancement (the number of individuals released) for a period of 1999-2019. Although fish were released at multiple locations within a watershed, we were unable to extract stocking data at the site level.

**Environmental data.** At each sampling site, we collected the following data as potential covariates: upstream watershed area (km^2^; a proxy for stream size), proportional land use in the upstream watershed (forest), local climates (annual mean air temperature [unit] and cumulative precipitation [mm]), and ocean productivity (Chlorophyll a [unit]). Annual data of ocean productivity (2003-2019) were extracted from OceanColor (<https://oceancolor.gsfc.nasa.gov/>) and the averaged value within the 30-km radius of each river mouth was calculated.

### Statistical analysis

Our goal is to compare temporal community dynamics across sites. However, the data are not directly comparable because of observation errors (e.g., different observers) and missing observations. To confront this challenge, we developed a Bayesian state space model for three species groups separately: (1) whole community, summed abundance of all species, (2) enhanced species, abundance of masu salmon, (3) unenhanced species, summed abundance of all species except masu salmon. A Bayesian state space model is best suited for our analysis because it can account for observation errors while imputing missing values given the long-term trend at each site. The model is composed of observation and state models as described below.

In the observation model, we model observation processes. Summed fish abundance of either whole community, enhanced species (masu salmon only), or unenhanced species at site $s$ in year $t$, $N_{s,t}$, was assumed to follow a Poisson distribution:

$$
\begin{aligned}
N_{s,t} \sim Poisson(\lambda_{s,t} A_{s,t}) &\text{(6)}
\end{aligned}
$$

where $\lambda_{s,t}$ is the expected fish density (individual m^-2^) and $A_{s,t}$ the sampling area (m^2^). Since fish sampling was conducted after the spring stocking of masu salmon, captured fish may include individuals released in the observation year. To avoid biases in estimating temporal community trends, we explicitly modeled this observation process:

$$
\begin{aligned}
\lambda_{s,t} = n_{s,t}exp(\epsilon_{s,t}^{obs}) + \psi \beta_s~Fry_{w(s),t} &\text{(7)}
\end{aligned}
$$

$n_{s,t}$ is the "true" fish density excluding fish released in the spring, $Fry_{w(s),t}$ the number of salmon fry released in spring in watershed $w$ within which site $s$ is located, and $\beta_s$ the site-specific effect of released salmon fry on the observed fish density. The error term $\epsilon_{s,t}^{obs}$ is drawn from a normal distribution as $\epsilon_{s,t}^{obs} \sim Normal(0, \sigma_{obs,s}^2)$ to account for site- and year-specific observation errors. The parameter $\psi$ equals zero when we model the unenhanced species group (otherwise $\psi = 1$) so we exclude the term $\beta_s~Fry_{w(j),t}$.

In the state model, we model temporal dynamics of fish density $n_{s,t}$ as follows:

$$
\begin{aligned}
ln~n_{s,t+1} = ln~r_{s} + ln~n_{s,t} + \epsilon_{s,t}^{state} &\text{(8)}
\end{aligned}
$$ where $ln~r_{s}$ is the site-specific rate of change at site $s$ and $\epsilon_{s,t}^{state}$ is the process error that is assumed to follow a normal distribution as $\epsilon_{s,t}^{state} \sim Normal(0, \sigma_{state,s}^2)$. The site-specific rate of change is random draws from a normal distribution $ln~r_s \sim Normal(\mu_r, \sigma_r^2)$, assuming that community dynamics across Hokkaido have a shared temporal trend to some degree (the degree of shared trend is controlled by the standard deviation $\sigma_r$). This hierarchical structure allows for improved estimates of $ln~r_s$ by sharing information across sites. We used median estimates of fish density $n_{s,t}$ to calculate temporal CVs, means ($\mu$), and SDs ($\sigma$). Raw time series data and estimated community dynamics are shown in **Figures S12-S15**.

We developed the following linear regression model taking either CV, species richness, mean, or SD as a response variable $y_s$ with a normal or Poisson distribution.

$$
\begin{aligned}
\left\{
\begin{array}{}
ln~y_s &\sim Normal(\mu_y, \sigma_y^2)~&&~\text{for CV, mean, and SD} &&&\text{(9a)}\\
y_s &\sim Poisson(\mu_{y,s}exp(\epsilon_{y,s}))~&&\text{for species richness} &&&\text{(9b)}
\end{array}
\right.
\end{aligned}
$$

where $\sigma_y$ is the SD of residual errors and $\epsilon_{y,s}$ is the normally-distributed error term that accounts for overdispersion ($\epsilon_{y,s} \sim Normal(0, \sigma_y^2)$). The expected mean $\mu_y$ was related to linear predictors as follows:

$$
\begin{aligned}
\left\{
\begin{array}{}
\mu_{y,s} &= \gamma_{0,w(s)} + \sum_k \gamma_kx_{k,s} &&\text{for CV, mean, and SD} &&&\text{(10a)}\\
ln~\mu_{y,s} &= \gamma_{0,w(s)} + \sum_k \gamma_kx_{k,s} &&\text{for species richness} &&&\text{(10b)}
\end{array}
\right.
\end{aligned}
$$

$\gamma_{0,w(s)}$ is the watershed-specific intercept ($w(s)$ refers to site $s$ nested within watershed $w$) and $\gamma_k (k > 0)$ are the regression coefficients of site-level predictor $x_k$. The site-level predictors include upstream watershed area, air temperature, precipitation, and forest land use (fraction). The watershed-specific intercept was related to watershed-level predictors as:

$$
\begin{aligned}
\gamma_{0,w} &\sim Normal(\mu_{\gamma,w},\sigma_{\gamma}^2)  &&\text{(11a)}\\
\mu_{\gamma,w} &=\delta_0+\sum_k\delta_k z_{k,w} &&\text{(11b)}
\end{aligned}
$$

$\delta_{0}$ is the watershed-specific intercept and $\delta_k (k > 0)$ are the regression coefficients. The watershed-level predictors $z_{k,w}$ include the number of released masu salmon and ocean productivity (sea surface chlorophyll a). The parameter $\sigma_{\gamma}$ accounts for random variation among watersheds that cannot be captured by the watershed-level predictors.

We fitted the models to the data using JAGS version 4.1.0 through *runjags* package in R. We assigned weakly informative priors for parameters, which were summarized in **Table S6**. Data manipulation and analysis were performed in R version 4.1.0.

# Data availability

# Acknowledgments

# References
